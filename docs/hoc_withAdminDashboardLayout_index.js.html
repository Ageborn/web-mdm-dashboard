---
layout: container
---

<div class="row">
  <div class="col-md-6">
        <a class="btn btn-lightweight no-outline navigation-btn">Index</a><ul role="navigation" id="sidenav-small" class="nav side-navigation side-navigation-small theme-default"><button type="button" class="close" data-dismiss="side-navigation" aria-label="close"><i class="glyph glyph-cancel"></i></button><li class="active side-nav-c2">Modules</li><ul class="nav collapse in" id="father-john-misty"><li><a href="module-animations.html">animations</a></li><li><a href="module-animations%2525252520WinJS.html">animations WinJS</a></li><li><a href="module-BuildItemList.html">BuildItemList</a></li><li><a href="module-bytesToSize.html">bytesToSize</a></li><li><a href="module-calc100PercentMinus.html">calc100PercentMinus</a></li><li><a href="module-configureDisplay.html">configureDisplay</a></li><li><a href="module-cookie.html">cookie</a></li><li><a href="module-getMode.html">getMode</a></li><li><a href="module-glpiApi.html">glpiApi</a></li><li><a href="module-handleMessage.html">handleMessage</a></li><li><a href="module-history.html">history</a></li><li><a href="module-itemtype.html">itemtype</a></li><li><a href="module-logout.html">logout</a></li><li><a href="module-nativeNotification.html">nativeNotification</a></li><li><a href="module-publicURL.html">publicURL</a></li><li><a href="module-setGlpiCookie.html">setGlpiCookie</a></li><li><a href="module-toDateInputValue.html">toDateInputValue</a></li><li><a href="module-updateObject.html">updateObject</a></li><li><a href="module-validateData.html">validateData</a></li><li><a href="module-validateDate.html">validateDate</a></li><li><a href="module-validateNotification.html">validateNotification</a></li></ul><li class="active side-nav-c2">Classes</li><ul class="nav collapse in" id="father-john-misty"><li><a href="AdminDashboardLayout.html">AdminDashboardLayout</a></li><li><a href="I18NTranslation.html">I18NTranslation</a></li><li><a href="RootApp.html">RootApp</a></li><li><a href="ToastNotification.html">ToastNotification</a></li></ul><li class="active side-nav-c2"><a href="global.html">Global</a><ul class="nav collapse in" id="father-john-misty"><li><a href="global.html#changeInput">changeInput</a></li><li><a href="global.html#changeState">changeState</a></li><li><a href="global.html#componentDidMount">componentDidMount</a></li><li><a href="global.html#fetchCaptcha">fetchCaptcha</a></li><li><a href="global.html#fetchSignIn">fetchSignIn</a></li><li><a href="global.html#fetchSignUp">fetchSignUp</a></li><li><a href="global.html#initialState">initialState</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#TIMEOUT_CONTRACT">TIMEOUT_CONTRACT</a></li><li><a href="global.html#withAdminDashboardLayout">withAdminDashboardLayout</a></li><li><a href="global.html#withAsyncComponent">withAsyncComponent</a></li><li><a href="global.html#withAuthenticationLayout">withAuthenticationLayout</a></li><li><a href="global.html#withGLPI">withGLPI</a></li><li><a href="global.html#withHandleMessages">withHandleMessages</a></li><li><a href="global.html#withI18NTranslation">withI18NTranslation</a></li><li><a href="global.html#withNotification">withNotification</a></li></ul></li></ul>
  </div>
    <div class="col-md-18 navigation-section">
    <div id="main">

        <h1 class="page-title">Source: hoc/withAdminDashboardLayout/index.js</h1>

        



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
*   Copyright © 2018 Teclib. All rights reserved.
*
*   This file is part of web-mdm-dashboard
*
* web-mdm-dashboard is a subproject of Flyve MDM. Flyve MDM is a mobile
* device management software.
*
* Flyve MDM is free software: you can redistribute it and/or
* modify it under the terms of the GNU General Public License
* as published by the Free Software Foundation; either version 3
* of the License, or (at your option) any later version.
*
* Flyve MDM is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
* ------------------------------------------------------------------------------
* @author     Gianfranco Manganiello (gmanganiello@teclib.com)
* @author     Hector Rondon (hrondon@teclib.com)
* @copyright  Copyright © 2018 Teclib. All rights reserved.
* @license    GPLv3 https://www.gnu.org/licenses/gpl-3.0.html
* @link       https://github.com/flyve-mdm/web-mdm-dashboard
* @link       http://flyve.org/web-mdm-dashboard
* @link       https://flyve-mdm.com
* ------------------------------------------------------------------------------
*/

import React, { PureComponent } from 'react'
import SplitView from "../../components/SplitView"
import HeaderBreadcrumb from '../../components/HeaderBreadcrumb'
import getMode from '../../shared/getMode'
import configureDisplay from '../../shared/configureDisplay'
import setGlpiCookie from '../../shared/setGlpiCookie'
import animationsWinJs from '../../shared/animationsWinJs/index'
import glpi from '../../shared/glpiApi'
import { I18n } from "react-i18nify"
import Confirmation from '../../components/Confirmation'
import { bindActionCreators } from 'redux'
import { connect } from 'react-redux'
import { logout } from '../../store/authentication/actions'

/** timeout to contract the lateral menu */
const TIMEOUT_CONTRACT = 150

function mapDispatchToProps(dispatch) {
    const actions = {
        logout: bindActionCreators(logout, dispatch)
    }
    return { actions }
}

/**
 * Wrapper component with the basic structure of the admin dashboard layout 
 * @param {component} WrappedComponent Component to wrap 
 * @return {component} The component with the admin dashboard layout
 */
const withAdminDashboardLayout = WrappedComponent => {
    class AdminDashboardLayout extends PureComponent {
        /** 
         * Create AdminDashboardLayout
         * @param {object} props
         */ 
        constructor(props) {
            super(props)
            this.state = {
                expanded: false,
                contract: false,
                mode: getMode(),
                iframe: undefined
            }

            window.addEventListener('resize', this.handleResize)
            configureDisplay()
            animationsWinJs()
        }

        /** Close current session */ 
        logout = async () => {
            const isOK = await Confirmation.isOK(this.contentDialog)
            if (isOK) {
                this.props.actions.logout(this.props.history)
            }
        }

        /** Change 'mode' according to the resolution of the screen */
        handleResize = () => {
            let prevMode = this.state.mode
            let nextMode = getMode()

            if (prevMode !== nextMode) {
                this.setState({ mode: nextMode })
            }
        }

        /** Configure 'baseURL' and the cookies of glpi */
        componentDidMount = async () => {
            const { cfg_glpi } = await glpi.getGlpiConfig()
            localStorage.setItem('baseURL', cfg_glpi.url_base)
            this.setState(
                { iframe: &lt;iframe title="glpi-backend" src={`//${cfg_glpi.url_base.split("//")[1]}`} style={{ height: 0, width: 0, opacity: 0, position: 'absolute' }}>&lt;/iframe> },
                () => setGlpiCookie(
                    this.setState({
                        iframe: undefined
                    })
                )
            )
        }

        /** Remove 'resize' event listener */
        componentWillUnmount() {
            window.removeEventListener('resize', this.handleResize)
        }

        /** Expand and collapse the side menu */
        handleToggleExpand = () => {
            this.state.expanded === false ? this.handleExpand() : this.handleContract()
        }

        /** Expand side menu */
        handleExpand = () => {
            this.setState({
                expanded: true,
                contract: false
            })
        }

        /** Collapse the side menu */
        handleContract = () => {
            this.setState({
                contract: true
            }, () => {
                this.handleSetTimeOut()
            })
        }

        /** Collapse the side menu after of the timeout */        
        handleSetTimeOut = () => {
            if (this.state.contract) {
                setTimeout(() => {
                    this.setState({
                        expanded: false,
                        contract: false
                    })
                }, TIMEOUT_CONTRACT)
            }
        }
        /** Render component */ 
        render() {
            return (
                &lt;main>

                    &lt;HeaderBreadcrumb
                        handleToggleExpand={this.handleToggleExpand}
                        location={this.props.history.location}
                    />

                    {(this.state.iframe || '')}

                    &lt;div className="flex-block">
                        &lt;SplitView
                            expanded={this.state.expanded}
                            contract={this.state.contract}
                            handleExpand={this.handleExpand}
                            handleContract={this.handleContract}
                            handleSetTimeOut={this.handleSetTimeOut}
                            handleToggleExpand={this.handleToggleExpand}
                            mode={this.state.mode}
                            logout={this.logout}
                        />
                        &lt;WrappedComponent {...this.props} mode={this.state.mode} />
                        &lt;Confirmation
                            title={I18n.t('logout.close_session')}
                            message={I18n.t('settings.security.close_session_message')}
                            reference={el => this.contentDialog = el}
                        />
                    &lt;/div>

                &lt;/main>
            )
        }
    }

    return connect(
        null,
        mapDispatchToProps
    )(AdminDashboardLayout)
}

export default withAdminDashboardLayout</code></pre>
        </article>
    </section>




    </div>
  </div>

<br class="clear">
